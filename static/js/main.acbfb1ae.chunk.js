(this.webpackJsonpdemo4onnxjs=this.webpackJsonpdemo4onnxjs||[]).push([[0],{33:function(t,e,n){},40:function(t,e,n){"use strict";n.r(e);var a=n(0),i=n(1),c=n.n(i),s=n(21),r=n.n(s),o=(n(33),n(7)),l=n(2),d=function(){return Object(a.jsxs)("div",{children:[Object(a.jsx)("h1",{children:"Demo for onnxjs"}),Object(a.jsx)("ul",{children:Object(a.jsx)("li",{children:Object(a.jsx)(o.b,{to:"/mnist",children:"MNIST"})})}),Object(a.jsxs)("ul",{children:[Object(a.jsx)("li",{children:Object(a.jsx)(o.b,{to:"https://github.com/hayashikun/demo4onnxjs",children:"hayashikun/demo4onnxjs"})}),Object(a.jsxs)("li",{children:[Object(a.jsx)(o.b,{to:"https://github.com/microsoft/onnxjs",children:"microsoft/onnxjs"}),Object(a.jsx)("ul",{children:Object(a.jsx)("li",{children:Object(a.jsx)(o.b,{to:"https://github.com/microsoft/onnxjs/blob/master/docs/operators.md",children:"operators.md"})})})]}),Object(a.jsxs)("li",{children:[Object(a.jsx)(o.b,{to:"https://github.com/onnx/onnx",children:"onnx/onnx"}),Object(a.jsx)("ul",{children:Object(a.jsx)("li",{children:Object(a.jsx)(o.b,{to:"https://github.com/onnx/onnx/blob/rel-1.2.3/docs/Operators.md",children:"Operators.md"})})})]})]})]})},u=n(26),h=n(12),j=n.n(h),v=n(18),b=n(9),p=n(19),x=n(23),O=n(24),f=n(27),g=n(25),m=function(t){Object(f.a)(n,t);var e=Object(g.a)(n);function n(){var t;Object(x.a)(this,n);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return(t=e.call.apply(e,[this].concat(i))).state={drawing:!1},t.hideCanvas=null,t.displayCanvas=null,t.startDrawing=function(e,n){var a;t.setState({drawing:!0});var i=null===(a=t.displayCanvas)||void 0===a?void 0:a.getContext("2d");null!=i&&(i.beginPath(),t.props.lineWidth&&(i.lineWidth=t.props.lineWidth),i.moveTo(e,n))},t.endDrawing=function(){var e;t.setState({drawing:!1});var n=null===(e=t.displayCanvas)||void 0===e?void 0:e.getContext("2d");null!=n&&n.closePath()},t.draw=function(e,n){var a;if(t.state.drawing){var i=null===(a=t.displayCanvas)||void 0===a?void 0:a.getContext("2d");null!=i&&(i.lineTo(e,n),i.stroke())}},t}return Object(O.a)(n,[{key:"getImageData",value:function(){var t,e,n=null===(t=this.displayCanvas)||void 0===t?void 0:t.getContext("2d"),a=null===(e=this.hideCanvas)||void 0===e?void 0:e.getContext("2d");if(null==n||null==a)return null;a.save(),a.scale(a.canvas.width/n.canvas.width,a.canvas.height/n.canvas.height),a.clearRect(0,0,a.canvas.width,n.canvas.height),a.drawImage(n.canvas,0,0),a.restore();for(var i=a.getImageData(0,0,this.props.dataWidth,this.props.dataHeight),c=new Float32Array(this.props.dataWidth*this.props.dataHeight),s=0;s<c.length;++s)c[s]=i.data[4*s+3]/255;return c}},{key:"clearCanvas",value:function(){var t,e,n=null===(t=this.displayCanvas)||void 0===t?void 0:t.getContext("2d"),a=null===(e=this.hideCanvas)||void 0===e?void 0:e.getContext("2d");if(null==this.displayCanvas||null==n||null==this.hideCanvas||null==a)return null;n.clearRect(0,0,n.canvas.width,n.canvas.height),a.clearRect(0,0,a.canvas.height,a.canvas.height)}},{key:"render",value:function(){var t=this;return Object(a.jsxs)("div",{children:[Object(a.jsx)("canvas",{ref:function(e){return t.hideCanvas=e},width:this.props.dataWidth+"px",height:this.props.dataHeight+"px",style:{display:"none"}}),Object(a.jsx)("canvas",{ref:function(e){return t.displayCanvas=e},width:this.props.displayWidth+"px",height:this.props.displayHeight+"px",id:"display-canvas",onMouseDown:function(e){return t.startDrawing(e.nativeEvent.offsetX,e.nativeEvent.offsetY)},onMouseUp:function(){return t.endDrawing()},onMouseLeave:function(){return t.endDrawing()},onMouseMove:function(e){return t.draw(e.nativeEvent.offsetX,e.nativeEvent.offsetY)},style:this.props.style})]})}}]),n}(c.a.Component),w=function(){var t=Object(i.useRef)(null),e=Object(i.useState)(""),n=Object(b.a)(e,2),c=n[0],s=n[1],r=Object(i.useState)("cpu"),o=Object(b.a)(r,2),l=o[0],d=o[1],h=Object(i.useState)(9),x=Object(b.a)(h,2),O=x[0],f=x[1],g=Object(i.useState)("Net1"),w=Object(b.a)(g,2),y=w[0],C=w[1],k=Object(i.useState)(null),S=Object(b.a)(k,2),M=S[0],D=S[1],I=Object(i.useState)(new Float32Array(10)),W=Object(b.a)(I,2),E=W[0],H=W[1],N=function(){var t=Object(v.a)(j.a.mark((function t(){var e;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s(""),e=new p.InferenceSession({backendHint:l}),t.prev=2,t.next=5,e.loadModel("/models/mnist_".concat(y,"_v").concat(O,".onnx"));case 5:s("mnist_".concat(y,"_v").concat(O," (").concat(l,")")),D(e),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(2),s("Error: "+t.t0);case 12:case"end":return t.stop()}}),t,null,[[2,9]])})));return function(){return t.apply(this,arguments)}}(),T=function(){var e=Object(v.a)(j.a.mark((function e(){var n,a,i,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(n=t.current)&&null!=M){e.next=3;break}return e.abrupt("return");case 3:if(null!=(a=n.getImageData())){e.next=6;break}return e.abrupt("return");case 6:return i=new p.Tensor(a,"float32",[1,1,28,28]),e.next=9,M.run([i]);case 9:c=e.sent,H(c.values().next().value.data);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(a.jsxs)("div",{style:{margin:"24px"},children:[Object(a.jsx)("h1",{children:"MNIST"}),Object(a.jsxs)("div",{children:["Model:",Object(a.jsxs)("select",{value:y,onChange:function(t){C(t.target.value),s("")},children:[Object(a.jsx)("option",{value:"Net1",children:"Net1"}),Object(a.jsx)("option",{value:"Net2",children:"Net2"})]})]}),Object(a.jsxs)("div",{children:["Backend:",Object(a.jsxs)("select",{value:l,onChange:function(t){d(t.target.value),s("")},children:[Object(a.jsx)("option",{value:"cpu",children:"cpu"}),Object(a.jsx)("option",{value:"webgl",children:"webgl"}),Object(a.jsx)("option",{value:"wasm",children:"wasm"})]})]}),Object(a.jsxs)("div",{children:["opset version:",Object(a.jsxs)("select",{value:O,onChange:function(t){f(parseInt(t.target.value)),s("")},children:[Object(a.jsx)("option",{value:"9",children:"9"}),Object(a.jsx)("option",{value:"10",children:"10"}),Object(a.jsx)("option",{value:"11",children:"11"}),Object(a.jsx)("option",{value:"12",children:"12"})]})]}),Object(a.jsxs)("div",{children:[Object(a.jsx)("button",{onClick:N,children:"Load"}),Object(a.jsx)("span",{children:c})]}),Object(a.jsx)(m,{ref:t,style:{border:"1px solid black",margin:"8px"},displayHeight:300,displayWidth:300,dataHeight:28,dataWidth:28,lineWidth:15}),Object(a.jsx)("button",{onClick:T,children:"Eval"}),Object(a.jsx)("button",{onClick:function(){var e=t.current;null!=e&&e.clearCanvas()},children:"Clear"}),Object(a.jsx)("ul",{children:function(){var t=Array.from({length:10},(function(t,e){return E[e]})),e=t.indexOf(Math.max.apply(Math,Object(u.a)(t)));return t.map((function(t,n){return Object(a.jsxs)("li",{style:{color:n===e?"red":"black"},children:[n,": ",t]},n)}))}()})]})},y=function(){return Object(a.jsx)(o.a,{basename:"",children:Object(a.jsxs)(l.d,{children:[Object(a.jsx)(l.b,{exact:!0,path:"/",component:d}),Object(a.jsx)(l.b,{exact:!0,path:"/mnist",component:w}),Object(a.jsx)(l.a,{from:"*",to:"/"})]})})},C=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,41)).then((function(e){var n=e.getCLS,a=e.getFID,i=e.getFCP,c=e.getLCP,s=e.getTTFB;n(t),a(t),i(t),c(t),s(t)}))};r.a.render(Object(a.jsx)(c.a.StrictMode,{children:Object(a.jsx)(y,{})}),document.getElementById("root")),C()}},[[40,1,2]]]);
//# sourceMappingURL=main.acbfb1ae.chunk.js.map