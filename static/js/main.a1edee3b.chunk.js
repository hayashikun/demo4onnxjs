(this.webpackJsonpdemo4onnxjs=this.webpackJsonpdemo4onnxjs||[]).push([[0],{33:function(e,t,n){},40:function(e,t,n){"use strict";n.r(t);var a=n(1),i=n(0),r=n.n(i),c=n(21),s=n.n(c),l=(n(33),n(12)),o=n(2),u=function(){return Object(a.jsxs)("div",{children:[Object(a.jsx)("h1",{children:"Demo for onnxjs"}),Object(a.jsx)("ul",{children:Object(a.jsx)("li",{children:Object(a.jsx)(l.b,{to:"/mnist",children:"MNIST"})})})]})},d=n(26),h=n(11),v=n.n(h),j=n(18),p=n(8),b=n(19),x=n(23),f=n(24),O=n(27),g=n(25),w=function(e){Object(O.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(x.a)(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).state={drawing:!1},e.hideCanvas=null,e.displayCanvas=null,e.startDrawing=function(t,n){var a;e.setState({drawing:!0});var i=null===(a=e.displayCanvas)||void 0===a?void 0:a.getContext("2d");null!=i&&(i.beginPath(),e.props.lineWidth&&(i.lineWidth=e.props.lineWidth),i.moveTo(t,n))},e.endDrawing=function(){var t;e.setState({drawing:!1});var n=null===(t=e.displayCanvas)||void 0===t?void 0:t.getContext("2d");null!=n&&n.closePath()},e.draw=function(t,n){var a;if(e.state.drawing){var i=null===(a=e.displayCanvas)||void 0===a?void 0:a.getContext("2d");null!=i&&(i.lineTo(t,n),i.stroke())}},e}return Object(f.a)(n,[{key:"getImageData",value:function(){var e,t,n=null===(e=this.displayCanvas)||void 0===e?void 0:e.getContext("2d"),a=null===(t=this.hideCanvas)||void 0===t?void 0:t.getContext("2d");if(null==n||null==a)return null;a.save(),a.scale(a.canvas.width/n.canvas.width,a.canvas.height/n.canvas.height),a.clearRect(0,0,a.canvas.width,n.canvas.height),a.drawImage(n.canvas,0,0),a.restore();for(var i=a.getImageData(0,0,this.props.dataWidth,this.props.dataHeight),r=new Float32Array(this.props.dataWidth*this.props.dataHeight),c=0;c<r.length;++c)r[c]=i.data[4*c+3]/255;return r}},{key:"clearCanvas",value:function(){var e,t,n=null===(e=this.displayCanvas)||void 0===e?void 0:e.getContext("2d"),a=null===(t=this.hideCanvas)||void 0===t?void 0:t.getContext("2d");if(null==this.displayCanvas||null==n||null==this.hideCanvas||null==a)return null;n.clearRect(0,0,n.canvas.width,n.canvas.height),a.clearRect(0,0,a.canvas.height,a.canvas.height)}},{key:"render",value:function(){var e=this;return Object(a.jsxs)("div",{children:[Object(a.jsx)("canvas",{ref:function(t){return e.hideCanvas=t},width:this.props.dataWidth+"px",height:this.props.dataHeight+"px",style:{display:"none"}}),Object(a.jsx)("canvas",{ref:function(t){return e.displayCanvas=t},width:this.props.displayWidth+"px",height:this.props.displayHeight+"px",id:"display-canvas",onMouseDown:function(t){return e.startDrawing(t.nativeEvent.offsetX,t.nativeEvent.offsetY)},onMouseUp:function(){return e.endDrawing()},onMouseLeave:function(){return e.endDrawing()},onMouseMove:function(t){return e.draw(t.nativeEvent.offsetX,t.nativeEvent.offsetY)},style:this.props.style})]})}}]),n}(r.a.Component),C=function(){var e=Object(i.useRef)(null),t=Object(i.useState)(""),n=Object(p.a)(t,2),r=n[0],c=n[1],s=Object(i.useState)("cpu"),l=Object(p.a)(s,2),o=l[0],u=l[1],h=Object(i.useState)(9),x=Object(p.a)(h,2),f=x[0],O=x[1],g=Object(i.useState)("Net1"),C=Object(p.a)(g,2),y=C[0],m=C[1],k=Object(i.useState)(null),S=Object(p.a)(k,2),M=S[0],D=S[1],I=Object(i.useState)(new Float32Array(10)),W=Object(p.a)(I,2),E=W[0],H=W[1],N=function(){var e=Object(j.a)(v.a.mark((function e(){var t;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(""),t=new b.InferenceSession({backendHint:o}),e.prev=2,e.next=5,t.loadModel("/models/mnist_".concat(y,"_v").concat(f,".onnx"));case 5:c("mnist_".concat(y,"_v").concat(f," (").concat(o,")")),D(t),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),c("Error: "+e.t0);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(){return e.apply(this,arguments)}}(),T=function(){var t=Object(j.a)(v.a.mark((function t(){var n,a,i,r;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=(n=e.current)&&null!=M){t.next=3;break}return t.abrupt("return");case 3:if(null!=(a=n.getImageData())){t.next=6;break}return t.abrupt("return");case 6:return i=new b.Tensor(a,"float32",[1,1,28,28]),t.next=9,M.run([i]);case 9:r=t.sent,H(r.values().next().value.data);case 11:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(a.jsxs)("div",{style:{margin:"24px"},children:[Object(a.jsx)("h1",{children:"MNIST"}),Object(a.jsxs)("div",{children:["Model:",Object(a.jsxs)("select",{value:y,onChange:function(e){m(e.target.value),c("")},children:[Object(a.jsx)("option",{value:"Net1",children:"Net1"}),Object(a.jsx)("option",{value:"Net2",children:"Net2"})]})]}),Object(a.jsxs)("div",{children:["Backend:",Object(a.jsxs)("select",{value:o,onChange:function(e){u(e.target.value),c("")},children:[Object(a.jsx)("option",{value:"cpu",children:"cpu"}),Object(a.jsx)("option",{value:"webgl",children:"webgl"}),Object(a.jsx)("option",{value:"wasm",children:"wasm"})]})]}),Object(a.jsxs)("div",{children:["opset version:",Object(a.jsxs)("select",{value:f,onChange:function(e){O(parseInt(e.target.value)),c("")},children:[Object(a.jsx)("option",{value:"9",children:"9"}),Object(a.jsx)("option",{value:"10",children:"10"}),Object(a.jsx)("option",{value:"11",children:"11"}),Object(a.jsx)("option",{value:"12",children:"12"})]})]}),Object(a.jsxs)("div",{children:[Object(a.jsx)("button",{onClick:N,children:"Load"}),Object(a.jsx)("span",{children:r})]}),Object(a.jsx)(w,{ref:e,style:{border:"1px solid black",margin:"8px"},displayHeight:300,displayWidth:300,dataHeight:28,dataWidth:28,lineWidth:15}),Object(a.jsx)("button",{onClick:T,children:"Eval"}),Object(a.jsx)("button",{onClick:function(){var t=e.current;null!=t&&t.clearCanvas()},children:"Clear"}),Object(a.jsx)("ul",{children:function(){var e=Array.from({length:10},(function(e,t){return E[t]})),t=e.indexOf(Math.max.apply(Math,Object(d.a)(e)));return e.map((function(e,n){return Object(a.jsxs)("li",{style:{color:n===t?"red":"black"},children:[n,": ",e]},n)}))}()})]})},y=function(){return Object(a.jsx)(l.a,{basename:"",children:Object(a.jsxs)(o.d,{children:[Object(a.jsx)(o.b,{exact:!0,path:"/",component:u}),Object(a.jsx)(o.b,{exact:!0,path:"/mnist",component:C}),Object(a.jsx)(o.a,{from:"*",to:"/"})]})})},m=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,41)).then((function(t){var n=t.getCLS,a=t.getFID,i=t.getFCP,r=t.getLCP,c=t.getTTFB;n(e),a(e),i(e),r(e),c(e)}))};s.a.render(Object(a.jsx)(r.a.StrictMode,{children:Object(a.jsx)(y,{})}),document.getElementById("root")),m()}},[[40,1,2]]]);
//# sourceMappingURL=main.a1edee3b.chunk.js.map